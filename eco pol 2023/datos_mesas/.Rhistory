url <- "http://www.bcra.gov.ar/Pdfs/PublicacionesEstadisticas/es_series.txt"
rm(list=ls())
library(dplyr)
library(installr)
library(rio)
BCRA.url <-"https://www.bcra.gob.ar/Pdfs/PublicacionesEstadisticas/debser.xls"
url <- "http://www.bcra.gov.ar/Pdfs/PublicacionesEstadisticas/es_series.txt"
destfile <- paste0(BCRA.url, "/debser.xls")
destfile2 <- paste0(url, "/es_series.txt")
download.file(BCRA.url, destfile)
download.file(url, destfile1)
rm(list=ls())
library(dplyr)
library(installr)
library(rio)
BCRA.url <-"https://www.bcra.gob.ar/Pdfs/PublicacionesEstadisticas/debser.xls"
url <- "http://www.bcra.gov.ar/Pdfs/PublicacionesEstadisticas/es_series.txt"
destfile <- paste0(BCRA.url, "/debser.xls")
destfile1 <- paste0(url, "/es_series.txt")
download.file(BCRA.url, destfile)
download.file(url, destfile1)
BCRA <- import("BCRA.html")
# Dólar paralelo
tc <- read.csv("https://api.bluelytics.com.ar/v2/evolution.csv")
tc <-subset(tc, tc$type == "Blue")
tc <- rename(tc, Fecha = day, Comprador = value_buy, Vendedor = value_sell)
tc
rm(list=ls())
library(dplyr)
library(installr)
library(rio)
# Dólar paralelo
tc <- read.csv("https://api.bluelytics.com.ar/v2/evolution.csv")
names(tc)
head(tc)
tc.b <- subset(tc, tc$type == "Blue")
tc.o <- subset(tc, tc$type == "Oficial")
tc.b <- rename(tc.b, Fecha = day, Comprador = value_buy, Vendedor = value_sell); tc.b
tc.o <- rename(tc.o, Fecha = day, Comprador = value_buy, Vendedor = value_sell); tc.o
summary(tc.b)
summary(tc.o)
rm(list=ls())
# Euro paralelo y euro oficial
tc <- read.csv("https://api.bluelytics.com.ar/v2/evolution.csv"); names(tc)
View(tc)
# Euro paralelo y euro oficial
tc <- read.csv("https://api.bluelytics.com.ar/v2/latest"); names(tc)
rm(list=ls())
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v2/latest"); names(tc)
names(tc2)
head(tc2)
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v2/evolution.json"); names(tc2)
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v2/evolution.csv"); names(tc2)
View(tc2)
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v1/evolution.csv"); names(tc2)
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v3/evolution.csv"); names(tc2)
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v2/latest"); names(tc2)
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v2/evolution.json"); names(tc2)
View(tc2)
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v2/evolution.json", get("euro")); names(tc2)
# Euro paralelo y euro oficial
tc2 <- read.csv("https://api.bluelytics.com.ar/v2/evolution.csv", get("euro")); names(tc2)
rm(list=ls())|
library(dplyr)
library(installr)
library(rio)
# Dólar blue y dólar oficial
tc <- read.csv("https://api.bluelytics.com.ar/v2/evolution.csv"); names(tc)
tc.blue <- subset(tc, tc$type == "Blue")
tc.oof <- subset(tc, tc$type == "Oficial")
tc.blue <- rename(tc.blue, Fecha = day, Comprador = value_buy, Vendedor = value_sell); tc.blue
tc.of <- rename(tc.of, Fecha = day, Comprador = value_buy, Vendedor = value_sell); tc.of
summary(tc.of)
rm(list=ls())|
library(dplyr)
library(installr)
library(rio)
# Dólar blue y dólar oficial
tc <- read.csv("https://api.bluelytics.com.ar/v2/evolution.csv"); names(tc)
tc.blue <- subset(tc, tc$type == "Blue")
tc.of <- subset(tc, tc$type == "Oficial")
tc.blue <- rename(tc.blue, Fecha = day, Comprador = value_buy, Vendedor = value_sell); tc.blue
tc.of <- rename(tc.of, Fecha = day, Comprador = value_buy, Vendedor = value_sell); tc.of
summary(tc.blue)
summary(tc.of)
rm(list=ls())
BCRA.url <-"https://www.bcra.gob.ar/Pdfs/PublicacionesEstadisticas/debser.xls"
url <- "http://www.bcra.gov.ar/Pdfs/PublicacionesEstadisticas/es_series.txt"
destfile <- paste0(BCRA.url, "/debser.xls")
destfile1 <- paste0(url, "/es_series.txt")
download.file(BCRA.url, destfile)
download.file(url, destfile1)
BCRA <- read.xlsx("https://www.bcra.gob.ar/Pdfs/PublicacionesEstadisticas/debser.xls")
library(openxlsx)
BCRA <- read.xlsx("https://www.bcra.gob.ar/Pdfs/PublicacionesEstadisticas/debser.xls")
rm(list=ls())
library(openxlsx)
BCRA <- read.xlsx("https://www.bcra.gob.ar/Pdfs/PublicacionesEstadisticas/debser.xls")
BCRA.url <-"https://www.bcra.gob.ar/PublicacionesEstadisticas/Cuadros_estandarizados_series_estadisticas.asp"
destfile <- paste0(BCRA.url, "/debser.xls")
download.file(BCRA.url, destfile)
destfile1 <- paste0(LELIQS.url, "/Historial_LELIQ.xlw")
download.file(LELIQS.url, destfile1)
BCRA.url <-"https://www.bcra.gob.ar/PublicacionesEstadisticas/Cuadros_estandarizados_series_estadisticas.asp"
LELIQS.url <-"https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp"
destfile <- paste0(BCRA.url, "/debser.xls")
download.file(BCRA.url, destfile)
destfile1 <- paste0(LELIQS.url, "/Historial_LELIQ.xlw")
download.file(LELIQS.url, destfile1)
download.file(BCRA.url, destfile)
download.file(LELIQS.url, destfile1)
destfile1 <- paste0(LELIQS.url, "/Historial-Leliq-Excel.asp?dato=1")
download.file(LELIQS.url, destfile1)
destfile1 <- paste0(LELIQS.url, "/Historial-Leliq-Excel.asp")
download.file(LELIQS.url, destfile1)
rm(list=ls())
library(rvest)
bcra <- "https://www.bcra.gob.ar/PublicacionesEstadisticas/Cuadros_estandarizados_series_estadisticas.asp"
tmisc <- bcra %>%
read_html() %>%
html_nodes(xpath = '/table table-BCRA table-bordered table-hover table-responsive') %>%
html_table()
library(tidyverse)
library(rvest)
bcra <- "https://www.bcra.gob.ar/PublicacionesEstadisticas/Cuadros_estandarizados_series_estadisticas.asp"
bcra <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Cuadros_estandarizados_series_estadisticas.asp")
View(bcra)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
rm(list=ls())
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
LELIQ <- bcra_LELIQ %>% html_elements("table")
View(LELIQ)
tabla <- LELIQ %>%
html_element("table")
View(tabla)
tabla <- LELIQ %>%
html_element("table") %>%
html_table()
View(tabla)
rm(list=ls())
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
LELIQ <- bcra_LELIQ %>% html_elements("table")
tabla <- LELIQ %>%
html_element("table table-BCRA table-bordered table-hover table-responsive") %>%
html_table()
tabla <- bcra_LELIQ %>% html_elements("tbody")
rm(list=ls())
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
nodos <- bcra_LELIQ %>% html_elements("tbody"); nodos
nodos <- bcra_LELIQ %>% html_elements("thead", "tbody"); nodos
nodos <- bcra_LELIQ %>% html_elements("tbody"); nodos
tabla <- nodos %>%
html_element("tr") %>%
html_element("td") %>%
html_table()
View(tabla)
tabla
tabla <- nodos %>%
html_element("tr") %>%
html_element("td") %>%
html_text2()
tabla
tabla <- nodos %>%
html_element("tr") %>%
html_element("td") %>%
html_element("div") %>%
html_text2()
tabla
tabla <- nodos %>%
html_element("tr") %>%
html_element("td") %>%
#html_element("div") %>%
html_text2()
tabla
tabla <- nodos %>%
html_element("tr") %>%
html_element("td") %>%
html_element("td") %>%
html_text2()
tabla
tabla <- nodos %>%
html_element("tr") %>%
html_element("td") %>%
#html_element("div") %>%
html_element("/td") %>%
html_text2()
tabla
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
nodos <- bcra_LELIQ %>% html_elements("tbody"); nodos
tabla <- nodos %>%
html_element("table") %>%
html_element("tr") %>%
html_element("td") %>%
html_text2()
tabla
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
nodos <- bcra_LELIQ %>% html_elements("table"); nodos
tabla <- nodos %>%
html_element("table") %>%
html_element("tbody") %>%
html_element("tr") %>%
html_element("td") %>%
html_text2()
tabla
nodos <- bcra_LELIQ %>% html_elements("table"); nodos
tabla <- nodos %>%
html_element("table") %>%
html_element("tbody") %>%
#html_element("tr") %>%
#html_element("td") %>%
html_text2()
tabla
nodos <- bcra_LELIQ %>% html_elements("table"); nodos
tabla <- nodos %>%
html_element("tbody") %>%
#html_element("tr") %>%
#html_element("td") %>%
html_text2()
tabla
tabla <- nodos %>%
html_element("tbody") %>%
html_element("tr") %>%
html_element("td") %>%
html_text2()
tabla
tabla <- nodos %>%
html_element("tbody") %>%
html_text2()
tabla
bcra_LELI
bcra_LELIQ
nodos
tabla <- nodos %>%
html_element("tbody") %>%
html_element("thead") %>%
html_text2()
tabla
View(nodos)
rm(list=ls())
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
nodos <- bcra_LELIQ %>% html_elements("table"); nodos
tbody <- nodos %>%
html_element("tbody") %>%
html_element("thead") %>%
html_text2()
tbody
tbody <- nodos %>%
html_element("tbody") %>%
html_text2()
tbody
View(nodos)
tbody <- nodos %>%
html_element("tbody") %>%
html_element("tr") %>%
html_element("td") %>%
html_text2()
tbody
tbody <- nodos %>%
html_element("tbody") %>%
html_text2()
tbody
tr <- tbody %>%
html_element("tr") %>%
html_text2()
tr
td <- tbody %>%
html_element("td") %>%
html_text2()
td
td <- tbody %>%
html_element("tr") %>%
html_element("td") %>%
html_text2()
td
tbody
td <- tbody %>%
html_element("t\r") %>%
html_element("t\d") %>%
td
rm(list=ls())
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
nodos <- bcra_LELIQ %>% html_elements("table"); nodos
tbody <- nodos %>%
html_element("tbody") %>%
html_table()
tbody
td <- tbody %>%
html_element("t\r") %>%
html_element("t\d") %>%
td
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
nodos <- bcra_LELIQ %>% html_elements("table"); nodos
tbody <- nodos %>%
html_element("tbody") %>%
html_table()
tbody
rm(list=ls())
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
nodos <- bcra_LELIQ %>% html_elements("table"); nodos
table <- nodos %>%
html_element("thead") %>%
html_element("tbody") %>%
html_table()
table
table <- nodos %>%
html_element("tbody") %>%
html_table()
table
rm(list=ls())
library(tidyverse)
library(rvest)
bcra_LELIQ <- read_html("https://www.bcra.gob.ar/PublicacionesEstadisticas/Historial-Leliq.asp")
nodos <- bcra_LELIQ %>% html_elements("table"); nodos
tabla <- nodos %>%
html_element("tbody") %>%
html_table()
tabla
GEN2023 <- fread("GEN2023.csv"); head(GEN2023)
total_votos <- as.numeric(sum(GEN2023$votos))
votos = GEN2023 %>%
group_by(distrito_id, distrito_nombre, seccion_id, circuito_id, agrupacion_nombre, anio) %>%
summarise(votos = sum(votos))
rm(list=ls())
library(installr)
library(R.utils)
library(dplyr)
library(data.table)
library(tidyverse)
library(rvest)
library(janitor)
library(rio)
library(here)
library(tmap)
library(sf)
library(glue)
library(scales)
library(htmltools)
library(leaflet)
library(stringr)
library(reshape)
gc()
directorio <- "C:\\Users\\IDECOR\\Documents\\Code\\Political_Economy\\eco pol 2023\\datos_mesas"
#directorio <- "C:\\Users\\stefa\\Documents\\Code\\Political_Economy\\eco pol 2023\\datos_mesas"
setwd(directorio); getwd()
################ ################ MAPA DEPARTAMENTAL 2023 ################ ################
{
# Base mesas
distrito <- import("distrito.csv", setclass = "data.table", encoding = "UTF-8")
seccion <- import("seccion.csv", setclass = "data.table", encoding = "UTF-8")
# Seba
deptnames <- import("Departamentos/deptnames.csv", setclass = "data.table", encoding = "UTF-8")
deptGEO <- import("Departamentos/deptnamesGEO.csv", setclass = "data.table", encoding = "UTF-8")
}
seccion$nombre <- toupper(seccion$nombre)
seccion <- rename(seccion, DEPARTA = nombre); head(seccion)
distrito$nombre <- toupper(distrito$nombre)
seccion$nombre <- toupper(seccion$nombre)
seccion <- dplyr::rename(seccion, DEPARTA = nombre); head(seccion)
distrito$nombre <- toupper(distrito$nombre)
distrito <- dplyr::rename(distrito, PROVINCIA = nombre); head(distrito)
seccionxdistrito <- merge(seccion, distrito, by = "distrito_id")
seccionxdistrito <- seccionxdistrito[, -c(3)]; head(seccionxdistrito); rm(seccion, distrito)
colnames(deptnames) <- c("DEPARTAMENTO", "NOMBRE"); head(deptnames)
colnames(deptGEO) <- c("index", "NOMBRE"); head(deptGEO)
nrow(deptnames); nrow(deptGEO)
# Quitamos ruido en nombres
Encoding(deptnames$NOMBRE) <- "UTF-8"
Encoding(deptGEO$NOMBRE) <- "UTF-8"
head(deptGEO)
head(deptnames)
deptnames$NOMBRE <- iconv(deptnames$NOMBRE, "latin1", "UTF-8")
deptGEO$NOMBRE <- iconv(deptGEO$NOMBRE, "latin1", "UTF-8")
head(deptGEO)
head(deptnames)
deptnames$NOMBRE <- gsub("¾", "Ñ", deptnames$NOMBRE)
deptGEO$NOMBRE <- gsub("¾", "Ñ", deptGEO$NOMBRE)
head(deptGEO)
head(deptnames)
deptnames$NOMBRE <- str_replace(deptnames$NOMBRE, "^[0-9]+\\s", "")
deptGEO$NOMBRE <- str_replace_all(deptGEO$NOMBRE, '"', '')
deptnames$NOMBRE <- str_replace_all(deptnames$NOMBRE, '"', '')
head(deptGEO)
head(deptnames)
deptnames$NOMBRE <- toupper(deptnames$NOMBRE)
deptGEO$NOMBRE <- toupper(deptGEO$NOMBRE)
deptnames$NOMBRE <- trimws(deptnames$NOMBRE)
deptGEO$NOMBRE <- trimws(deptGEO$NOMBRE)
head(deptGEO)
head(deptnames)
deptnames$NOMBRE <- gsub("[^[:print:]]", "", deptnames$NOMBRE)
deptGEO$NOMBRE <- gsub("[^[:print:]]", "", deptGEO$NOMBRE)
head(deptGEO)
head(deptnames)
class(deptnames); class(deptGEO)
class(deptnames$NOMBRE); class(deptGEO$NOMBRE)
deptnames$index <- as.integer(str_extract(deptnames$DEPARTAMENTO, "\\d+"))
head(deptnames)
head(deptGEO)
identical(deptnames$NOMBRE, deptGEO$NOMBRE)
identical(deptnames$index, deptGEO$index)
class(deptnames$index); class(deptGEO$index)
fwrite(deptGEO, "deptGEO.csv")
fwrite(deptnames, "deptnames.csv")
gc() # Not to overload
dept <- left_join(deptnames, deptGEO, by = "NOMBRE"); head(dept)
fwrite(dept, "Departamentos/namesdept.csv")
rm(deptGEO); rm(deptnames)
# # # Geometrías departamentales # # #
dptos <- st_read("~/Code/Political_Economy/eco pol 2023/datos_mesas/Departamentos/departamentos.shp"); names(dptos)
dptos <- dptos[dptos$OBJECTID!="488"&dptos$OBJECTID!="489",] # Elimina Islas Malvinas y Antartida
gc() # Not to overload
head(dptos)
head(dept)
head(seccionxdistrito)
identical(dept$NOMBRE, seccionxdistrito$DEPARTA)
identical(dept$NOMBRE, dptos$DEPARTA)
identical(dptos$DEPARTA, seccionxdistrito$DEPARTA)
seccionxdistrito <- rename(seccionxdistrito, seccion_nombre = DEPARTA)
dept <- rename(dept, seccion_nombre = NOMBRE)
seccionxdistrito <- dplyr::rename(seccionxdistrito, seccion_nombre = DEPARTA)
dept <- dplyr::rename(dept, seccion_nombre = NOMBRE)
dptos <- dplyr::rename(dptos, seccion_nombre = DEPARTA)
gc() # Not to overload
merge <- left_join(seccionxdistrito, dept, by = "seccion_nombre")
departamentos <- left_join(dptos, merge, by = "seccion_nombre")
head(departamentos)
departamentos <- departamentos[, -c(1, 5, 6, 7, 9, 10, 11, 12)]
departamentos <- dplyr::rename(departamentos, distrito_nombre = PROVINCIA.x); head(departamentos)
# Guardamos geometrías departamentales
st_write(departamentos, "departamentos.gpkg", append = FALSE)
rm(list=ls()) ######## ######## ######## ######## ######## ######## ########
GEN2023 <- fread("GEN2023.csv"); head(GEN2023)
dptos <- fread("deptGEO.csv");head(dptos)
View(dptos)
View(GEN2023)
rm(list=ls())
# # # Geometrías departamentales # # #
dptos <- st_read("~/Code/Political_Economy/eco pol 2023/datos_mesas/Departamentos/departamentos.shp"); names(dptos)
dptos <- dptos[dptos$OBJECTID!="488"&dptos$OBJECTID!="489",] # Elimina Islas Malvinas y Antartida
gc() # Not to overload
head(dptos)
rm(list=ls())
GEN2023 <- fread("GEN2023.csv"); head(GEN2023)
dptos <- fread("deptGEO.csv"); head(dptos)
secciones <- fread("seccion.csv"); head(secciones)
secciones$nombre <- toupper(secciones$nombre); head(secciones)
secciones <- dplyr::rename(secciones, NOMBRE = nombre); names(secciones)
distritos <- merge(dptos, secciones, by = "NOMBRE")
head(distritos)
GEN2023 <- fread("GEN2023.csv")
dptos <- fread("deptGEO.csv")
GEN2023 <- fread("GEN2023.csv"); head(GEN2023)
rm(list=ls())
dptos <- fread("deptGEO.csv")
secciones <- fread("seccion.csv"); head(secciones)
secciones$nombre <- toupper(secciones$nombre); head(secciones)
secciones <- dplyr::rename(secciones, NOMBRE = nombre); names(secciones)
dptos <- fread("deptGEO.csv"); head(dptos)
dept <- merge(dptos, secciones, by = "NOMBRE")
dept <- dplyr::rename(dept, seccion_nombre = NOMBRE); names(dept)
head(dept)
GEN2023 <- fread("GEN2023.csv"); head(GEN2023)
dept <- merge(GEN2023, dept, by = "seccion_id")
rm(list=ls())
dptos <- fread("deptGEO.csv"); head(dptos)
secciones <- fread("seccion.csv"); head(secciones)
secciones$nombre <- toupper(secciones$nombre); head(secciones)
secciones <- dplyr::rename(secciones, NOMBRE = nombre); names(secciones)
dept <- merge(dptos, secciones, by = "NOMBRE")
dept <- dplyr::rename(dept, seccion_nombre = NOMBRE); names(dept)
head(dept)
generales <- fread("GEN2023.csv"); head(GEN2023)
head(generales)
GEN2023 <- merge(GEN2023, dept, by = "seccion_id")
GEN2023 <- merge(generales, dept, by = "seccion_id")
gc()
GEN2023 <- merge(generales, dept, by = "seccion_id", allow.cartesian = TRUE)
head(GEN2023)
View(GEN2023)
rm(dept, dptos, generales, secciones)
total_votos <- as.numeric(sum(GEN2023$votos))
votos = GEN2023 %>%
group_by(distrito_id, distrito_nombre, seccion_id, circuito_id, agrupacion_nombre, anio) %>%
summarise(votos = sum(votos))
votos
rm(list=ls())
